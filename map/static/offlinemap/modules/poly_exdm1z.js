/**/ï»¿_jsload&&_jsload('poly', 'w.DOM_ATTRS={strokecolor:1,strokeweight:1,strokeopacity:1,fillcolor:1,fillopacity:1,strokelinecap:1,strokelinejoin:1,strokestyle:1,topfillcolor:1,topfillopacity:1,sidefillcolor:1,sidefillopacity:1};C.extend(w.prototype,{initialize:function(T){if(T&&this._graphMouseEvent){T.addEventListener("onmousemove",this._graphMouseEvent)}if(T&&this._graphClickEvent){T.addEventListener("onclick",this._graphClickEvent);T.addEventListener("ondblclick",this._graphClickEvent);T.addEventListener("onrightclick",this._graphClickEvent);T.addEventListener("onrightdblclick",this._graphClickEvent)}if((this._config.strokeStyle==="dashed"||this._config.strokeStyle==="dotted")&&T.getRenderType()==="webgl"&&!this._config.texture){this._generateTexture()}var e=cP.prototype.initialize.call(this,T);if(this._config.enableEditing===true&&!this._config.geodesic){var i=this;setTimeout(function(){i.clearVertexs();i.addVertexs()},0)}return e},_generateTexture:function(){var hK=this._config;var T=hK.dashArray;var hJ=document.createElement("canvas");var e;var hI;if(hK.strokeStyle==="dashed"){e=16;hI=e*8}else{if(hK.strokeStyle==="dotted"){e=32;hI=e*2}}hJ.width=e;hJ.height=hI;var i=hJ.getContext("2d");i.fillStyle=hK.strokeColor;i.globalAlpha=hK.strokeOpacity;if(hK.strokeStyle==="dashed"){this._drawDashArrayTexture(i,e,hI)}else{if(hK.strokeStyle==="dotted"){this._drawDottedTexture(i,e,hI)}}this._config.texture=hJ;this._config.textureSize=[e,hI]},_drawDashArrayTexture:function(hO,hI,hK){var T=this._config;var hM=T.dashArray;if(!hM){hO.fillRect(0,0,hI,hK/2);this._totalDashLen=T.strokeWeight*4}else{var hN=0;if(hM.length%2!==0){hM=hM.concat(hM)}for(var hJ=0;hJ<hM.length;hJ++){hN+=hM[hJ]}var e=0;for(var hJ=0;hJ<hM.length;hJ++){var hL=hM[hJ]/hN*hK;if(hJ%2===0){hO.fillRect(0,e,hI,hL)}e+=hL}this._totalDashLen=hN}},_drawDottedTexture:function(i,e,T){i.beginPath();i.arc(e/2,e/2,e/2,0,2*Math.PI);i.fill();i.closePath();this._totalDashLen=this._config.strokeWeight*2},_addDom:function(){if(this.map._renderType==="webgl"){return}var e=this._drawer=br.getDrawer(this.map);this.domElement=e.addLine()},_bind:function(){var e=this.domElement;var hI=this;function hK(hQ,hO){var hN=hQ.srcElement||hQ.target;var hM=fB();var i=hQ.pageX?hQ.pageX:(hQ.clientX+hM[1]);var hS=hQ.pageY?hQ.pageY:(hQ.clientY+hM[0]);if(hQ&&hO&&i&&hS&&hN){var hP=C.I(hN.hashCode).map;var hR=C.Dom.getOffset(hP.container);hO.pixel=new eb(i-hR.left,hS-hR.top);hO.point=hP.pixelToPointIn(hO.pixel);hO.latLng=hP.pixelToPoint(hO.pixel);return hO}else{return hO}}if(e&&br.getDrawer(this.map).getType()!=="canvas"){C.on(e,"click",function(i){hI.dispatchEvent(hK(i,new a6("onclick").inherit(i)))});C.on(e,"mousedown",function(i){hI.dispatchEvent(hK(i,new a6("onmousedown").inherit(i)))});C.on(e,"mouseup",function(i){hI.dispatchEvent(hK(i,new a6("onmouseup").inherit(i)))});C.on(e,"dblclick",function(i){hI.dispatchEvent(hK(i,new a6("ondblclick").inherit(i)))})}e=null;if(!this._binded){this._binded=true;this.enableEventListen=true;this._graphMouseEvent=function(hP){if(!hI.map){return}if(hI.map.getMapType()==="B_EARTH_MAP"){return}if(hI instanceof bj.PolylineMultipart||hI instanceof bj.Marker3D){return}if(hI.map.temp._draggingMarker){return}if(!hI.enableEventListen){return}var hM;if(hP.overlay&&hP.overlay.toString()==="Marker"){if(!hP.overlay.keepWhenMousemoveOn){if(hI._temp.ismouseout===false&&hI._temp.ismouseover===true){hI._temp.ismouseover=false;hI._temp.ismouseout=true;hM=new a6("onmouseout");hI.dispatchEvent(hM)}return}}var i=hP.point;var hO;if(hI.toString()!=="Polyline"){hO=hI._getInPnpoly(i)}else{hO=hI._getProximity(i)}var hN=hO.dist;if(hN>=0&&hN<hI._config.mouseOverTolerance){if(!hI._temp.ismouseover){hI._temp.ismouseover=true;hI._temp.ismouseout=false;hM=new a6("onmouseover")}else{hM=new a6("onmousemove");hI.map.platform.style.cursor="pointer"}}else{if(!hI._temp.ismouseout&&hI._temp.ismouseover){hI._temp.ismouseover=false;hI._temp.ismouseout=true;hM=new a6("onmouseout");hI.map.platform.style.cursor=hI.map.config.defaultCursor}}if(hM){if(hI.toString()!=="Polyline"&&hM.type==="onmousemove"&&hI._temp.ismouseover===true&&(hN===0||hN>hI._config.mouseOverTolerance)){hM.pixel=hP.pixel;hM.point=hP.point;hM.latLng=this.overlayPixelToPoint(hP.pixel)}else{hM.point=this.overlayPixelToPointIn(hO.pixel);hM.pixel=this.pointToPixelIn(hM.point);hM.latLng=this.overlayPixelToPoint(hO.pixel)}hI.dispatchEvent(hM)}};this._graphClickEvent=function(hP){if(!hI.map){return}if(hI.map.getMapType()==="B_EARTH_MAP"){return}if(hI instanceof bj.PolylineMultipart||hI instanceof bj.Marker3D){return}if(hI.map.temp._draggingMarker){return}if(!hI.enableEventListen){return}var hM;var i=hP.point;var hO;if(hI.toString()!=="Polyline"){hO=hI._getInPnpoly(i)}else{hO=hI._getProximity(i)}var hN=hO.dist;if(hN>=0&&hN<hI._config.mouseOverTolerance){hM=new a6(hP.type)}if(hM){if(hI.toString()!=="Polyline"&&hM.type==="onmousemove"&&hI._temp.ismouseover===true&&(hN===0||hN>hI._config.mouseOverTolerance)){hM.pixel=hP.pixel;hM.point=hP.point;hM.latLng=this.overlayPixelToPoint(hP.pixel)}else{hM.point=this.overlayPixelToPointIn(hO.pixel);hM.pixel=this.pointToPixelIn(hM.point);hM.latLng=this.overlayPixelToPoint(hO.pixel)}hI.dispatchEvent(hM)}};this.map.addEventListener("onmousemove",this._graphMouseEvent);var hJ=["onclick","dblclick","onrightclick","onrightdblclick"];for(var T=0;T<hJ.length;T++){var hL=hJ[T];this.map.addEventListener(hL,this._graphClickEvent)}this.addEventListener("mouseover",function(i){if(!this.map){return}});this.addEventListener("mouseout",function(i){if(!this.map){return}});this.map.addEventListener("movestart",function(){hI.enableEventListen=false;hI._mouseEventPixels=null});this.map.addEventListener("moveend",function(){hI.enableEventListen=true});this.map.addEventListener("zoomstart",function(){hI.enableEventListen=false;hI._mouseEventPixels=null});this.map.addEventListener("zoomend",function(){hI.enableEventListen=true});this.map.on("center_changed",function(){hI._mouseEventPixels=null});this.map.on("zoom_changed",function(){hI._mouseEventPixels=null});this.map.on("load",function(){hI._mouseEventPixels=null})}},draw:function(hJ){if(!this.domElement){return}var hI=this.map;if(hI.getMapType()==="B_EARTH_MAP"||hI._renderType==="webgl"){return}hJ=hJ||{};var T=this.points.slice(0);if(this.greatCirclePoints.length>0){T[0]=this.greatCirclePoints}var i=this._getDisplayPixels(T,hJ.zoom,hJ.center);if(this._drawer){this._drawer.setPath(this.domElement,i)}},_draw:function(){if(this.map){this.initialize(this.map);if(this.domElement){this.domElement.style.WebkitUserSelect="none"}this.draw()}},_getDisplayPixels:function(hM,hN,e){var hI=this.map;var hL=[];if(hM.length==0||!this.isVisible()){return[hL]}if(hI._renderType!=="webgl"&&!this.domElement){return[hL]}var T=hM;if(!this._config.enableEditing&&this._config.enableParse){T=this._simplification(hM)}var hK=[];if(hM[0] instanceof hj){var hO=this._toOverlayPixels(T,hN,e);hK.push(hO.pixels);hK.isOnBack=hO.isOnBack}else{hK.isOnBack=false;for(var hJ=0;hJ<T.length;hJ++){var hO=this._toOverlayPixels(T[hJ],hN,e);hK.push(hO.pixels);if(hO.isOnBack===true){hK.isOnBack=true}}}return hK},_toOverlayPixels:function(hN,hQ,e){var T=this.map;var hO;var hP=[];var hM=T.pointToOverlayPixelIn(hN[0],{zoom:hQ,center:e});hP.push(hM);if(hM.onBack){hO=true}for(var hK=1,hJ=1,hI=hN.length;hK<hI;hK++){var hL=T.pointToOverlayPixelIn(hN[hK],{zoom:hQ,center:e});if(hL.onBack){hO=true}if(!hL.equals(hP[hJ-1])){hP.push(hL);hJ++}}return{pixels:hP,isOnBack:hO}},getParseCacheIndex:function(e){e=Math.floor(e);if(this._config.getParseCacheIndex){return this._config.getParseCacheIndex(e)}if(e<6){return 0}if(e<10){return 1}if(e<15){return 2}return 3},getParseTolerance:function(i,e){i=Math.floor(i);if(this._config.getParseTolerance){return this._config.getParseTolerance(i,e)}return w.parseTolerance[e][this.getParseCacheIndex(i)]},setPoints:function(i){this._clearCache();this.points=w.getGraphPoints(i).slice(0);this._calcBounds();this.draw();var e=new a6("onlineupdate");e.overlay=this;this.dispatchEvent(e)},setPointAt:function(T,e){if(!e||!this.points[T]){return}this._clearCache();this.points[T]=new hj(e.lng,e.lat);this._calcBounds();this.draw();var i=new a6("onlineupdate");i.overlay=this;this.dispatchEvent(i)},setPositionAt:function(i,e){if(!e||!this.points[i]){return}var T=ef.convertLL2MC(e);this.setPointAt(i,T);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs();this.addVertexs()}},setOptions:function(i){i=i||{};var T=this.isStyleUseTexture();for(var e in i){if(i.hasOwnProperty(e)){var hJ=this._config[e];var hI=i[e];this._config[e]=hI;if(hI!==hJ&&(e==="strokeColor"||e==="strokeOpacity"||e==="strokeWeight")){if(this._config.texture){this._config.texture=null}if(T){this._generateTexture()}}if(this.map){this._setDomAttribute(e.toLowerCase(),i[e])}}}},isStyleUseTexture:function(){if(!this.map){return false}if(this.map.getRenderType()!=="webgl"){return false}return this._config.strokeStyle==="dashed"||this._config.strokeStyle==="dotted"},setStrokeColor:function(e){this.setOptions({strokeColor:e})},setStrokeLineCap:function(e){if(this._config){this._config.strokeLineCap=e}this._setDomAttribute("strokelinecap",e)},setStrokeLineJoin:function(e){if(this._config){this._config.strokeLineJoin=e}this._setDomAttribute("strokelinejoin",e)},setStrokeWeight:function(e){if(e>0){this._config.strokeWeight=e;if(!this.map){return}this._setDomAttribute("strokeweight",e)}},setStrokeOpacity:function(e){if(!e||e>1||e<0){return}this._config.strokeOpacity=e;if(!this.map){return}this._setDomAttribute("strokeopacity",e)},setFillOpacity:function(e){if(e>1||e<0){return}this._config.fillOpacity=e;this._setDomAttribute("fillopacity",e)},setStrokeStyle:function(e){if(e!="solid"&&e!="dashed"&&e!="dotted"){return}this._config.strokeStyle=e;this._setDomAttribute("strokestyle",e)},setFillColor:function(e){this._config.fillColor=e||"";this._setDomAttribute("fillcolor",e)},_setDomAttribute:function(i,T){if(!w.DOM_ATTRS[i]){return}if(this._drawer){if(T===false||T===null||typeof T==="undefined"){T=""}this._drawer.setAttribute(this.domElement,i,T,this._config)}var e=new a6("onlineupdate");e.overlay=this;this.dispatchEvent(e);if(i==="strokeweight"&&this.getStrokeStyle()==="dashed"&&br.getDrawer(this.map)&&br.getDrawer(this.map).getType()==="svg"){this._setDomAttribute("strokestyle","dashed")}},addVertexs:function(){var hM=this;if(hM.vertexMarkers.length){return}var hN=this.getVertexPoints();var hL;for(var hK=0,hI=hN.length;hK<hI;hK++){var e=hN[hK];if(e.t){hL=eV.imgPath+"nodeT.gif"}else{hL=eV.imgPath+"node.gif"}var T=new g2(hL,new d1(11,11),{offset:new d1(5,5)});var hJ=new dk(e.p,{icon:T});hJ.enableDragging(true);hJ.addEventListener("ondragging",function(i){hM._onMarkerDragging(i)});hJ.addEventListener("ondragstart",function(i){hM._onMarkerDragstart(i)});hJ.addEventListener("ondragend",function(i){hM._onMarkerDragend(i)});hJ.addEventListener("onmarkerdelvertex",function(i){hM._onMarkerDelVertex(i)});hJ.index=hK;hJ.t=e.t;this.vertexMarkers.push(hJ);this.map?this.map.addOverlay(hJ):""}},clearVertexs:function(){var e;while(e=this.vertexMarkers.pop()){this.map.removeOverlay(e);e=undefined}this.vertexMarkers.length=0},getVertexPoints:function(){var hK=[];for(var hJ=0,T=this.points.length;hJ<T;hJ++){var hL=this.points[hJ];hK.push({p:hL,t:0});if(hJ<T-1){var e=this.points[hJ+1];var hI=new hj((hL.lng+e.lng)/2,(hL.lat+e.lat)/2);hK.push({p:hI,t:1})}}this.vertexPoints=hK;return hK},delVertex:function(e){this.map.removeOverlay(this.vertexMarkers[e]);this.vertexPoints.splice(e,1);this.vertexMarkers.splice(e,1)},_onMarkerDragging:function(i){},_onMarkerDragstart:function(T){this._editstate=false;var i=new a6("oneditstart");i.pixel=T.pixel;i.point=T.point;i.latLng=T.latLng;i.overlay=this;this.dispatchEvent(i)},_onMarkerDragend:function(hM){this.vertexPoints.length=0;this._editstate=false;if(this._temp.dashedLine){this.map.removeOverlay(this._temp.dashedLine);delete this._temp.dashedLine}if(this._temp.preTNode){this.map.removeOverlay(this._temp.preTNode);delete this._temp.preTNode}if(this._temp.nexTNode){this.map.removeOverlay(this._temp.nexTNode);delete this._temp.nexTNode}var hL=hM.currentTarget;var hN=hM.point;var T=hL.index;var hK;if(T%2!=0){T=Math.ceil(T/2);hK=this.points.slice();var hJ=this.points.length-T;var hI=hK.splice(T,hJ);hK[hK.length]=hN;hK=hK.concat(hI)}else{T=T/2;this.points.splice(T,1,hN);if(this instanceof aM&&this.points.length-1==T){this.points.splice(0,1,hN)}hK=this.points}this.clearVertexs();this.setPoints(hK);this.addVertexs();var i=new a6("oneditend");i.pixel=hM.pixel;i.point=hM.point;i.latLng=hM.latLng;i.overlay=this;this.dispatchEvent(i);this._mouseEventPixels=null},_onMarkerDelVertex:function(hK){if(this.toString()!=="Polyline"&&this.toString()!=="Polygon"){return}if(hK.target.type===0||hK.target.t===0){var hJ=[];if(this.vertexPoints.length<4&&this.toString()==="Polyline"){return}if(this.vertexPoints.length<8&&this.toString()==="Polygon"){return}if(this.toString()==="Polygon"&&(hK.target.index===0||hK.target.index===(this.vertexPoints.length-1))){this.delVertex(this.vertexPoints.length-1);this.delVertex(0)}else{this.delVertex(hK.target.index)}for(var hI=0;hI<this.vertexPoints.length;hI++){if(this.vertexPoints[hI].t===0){hJ.push(this.vertexPoints[hI].p)}}this.points=hJ;if(this.points[0].lng===this.points[this.points.length-1].lng&&this.points[0].lat===this.points[this.points.length-1].lat){this.points.splice(this.points.length-1,1)}this.clearVertexs();this.setPoints(this.points);this.addVertexs();var T=new a6("oneditend");T.pixel=hK.pixel;T.point=hK.point;T.latLng=hK.latLng;T.overlay=this;this.dispatchEvent(T);this._mouseEventPixels=null}},_getInPnpoly:function(T){var hI;var hM=[];var e=this.map.pointToOverlayPixelIn(T);if(this._mouseEventPixels){hM=this._mouseEventPixels}else{if(!(this.points[0] instanceof hj)){var hL=this._getDisplayPixels(this.points);for(var hK=0;hK<hL.length;hK++){hL[hK].push(hL[hK][0]);hM=hM.concat(hL[hK])}}else{hM=this._getDisplayPixels(this.points)[0]}this._mouseEventPixels=hM}var hJ=this._pixelPnpoly(e,hM);hI=hJ?0:1000;return{pixel:e,dist:hI}},_getProximity:function(hT){var T,hJ,hU,hM,hL,hS,hR,hQ=[];var hV=this.map.pointToOverlayPixelIn(hT);if(this._mouseEventPixels){hQ=this._mouseEventPixels}else{hQ=this._getDisplayPixels(this.points)[0];this._mouseEventPixels=hQ}var hY=hQ.length;if(hY>1){for(var hW=1;hW<hY;hW++){var hO=hQ[hW-1];var h2=hQ[hW];if(!hO||!h2){continue}if(hO.x!=h2.x){var h1=(h2.y-hO.y)/(h2.x-hO.x);var hZ=h2.y-h1*h2.x;hR=Math.abs(h1*hV.x+hZ-hV.y)/Math.sqrt(h1*h1+1)}else{hR=Math.abs(hV.x-h2.x)}var hX=Math.pow(h2.y-hO.y,2)+Math.pow(h2.x-hO.x,2);var hI=Math.pow(h2.y-hV.y,2)+Math.pow(h2.x-hV.x,2);var h0=Math.pow(hO.y-hV.y,2)+Math.pow(hO.x-hV.x,2);var hK=Math.pow(hR,2);var e=hI-hK+h0-hK;if(e>hX){hR=Math.sqrt(Math.min(hI,h0))}if((T==null)||(T>hR)){hJ=Math.sqrt(h0-hK)/Math.sqrt(hX);hU=Math.sqrt(hI-hK)/Math.sqrt(hX);T=hR;hS=hW}T=Math.min(T,hR)}if(hJ>1){hJ=1}if(hU>1){hJ=0;hU=1}var hP=hQ[hS-1].x-hQ[hS].x;var hN=hQ[hS-1].y-hQ[hS].y;hM=hQ[hS-1].x-(hP*hJ);hL=hQ[hS-1].y-(hN*hJ)}return{pixel:new eb(hM,hL),dist:T}},_pixelPnpoly:function(hJ,hL){var e=hL.length;var T=0;var hK=false;for(var hI=0;hI<e;hI++){T=(hI===e-1)?0:T+1;if((hL[hI].y!==hL[T].y)&&(((hJ.y>=hL[hI].y)&&(hJ.y<hL[T].y))||((hJ.y>=hL[T].y)&&(hJ.y<hL[hI].y)))&&(hJ.x<(hL[T].x-hL[hI].x)*(hJ.y-hL[hI].y)/(hL[T].y-hL[hI].y)+hL[hI].x)){hK=!hK}}return hK},getMinDistance:function(i){var e=this._getProximity(i);var T=this.map.overlayPixelToPointIn(e.pixel);return this.map.getDistanceIn(i,T)},buildVertex:function(hJ,hP){var hM=[];var hQ=[];var hS=this.points.slice(0);var hT=[];if(this.greatCirclePoints.length>0){hS[0]=this.greatCirclePoints}var T=w.JOININDEX[this._config.strokeLineJoin];var hR=w.CAPINDEX[this._config.strokeLineCap];var hI=this.getStrokeColorForGL();var e=this._config.strokeWeight/2;var hL=this.map.getZoom();if(hS.length>500&&hS[0] instanceof hj){if(!hP&&this._lastResult){return this._lastResult}var hO=this._getDisplayPixelsGLWithCut(hS);for(var hK=0;hK<hO.length;hK++){if(hO[hK].length<2){continue}if(hM.length/6+hJ.getVertexCount(hO[hK].length)>65536){hT.push([hM,hQ]);hM=[];hQ=[]}hJ.buildData(hO[hK],T,hR,hM,hQ,hI,e)}hT.push([hM,hQ]);hT.inCache=false;this._lastResult=hT;return hT}var hN=this.getParseCacheIndex(this.map.getZoom());if(hP!==true&&this._parseCacheGL[hN]){this._parseCacheGL[hN].inCache=true;return this._parseCacheGL[hN]}var hO=this._getDisplayPixelsGL(hS);for(var hK=0;hK<hO.length;hK++){if(hO[hK].length<2){continue}if(hM.length/6+hJ.getVertexCount(hO[hK].length)>65536){hT.push([hM,hQ]);hM=[];hQ=[]}hJ.buildData(hO[hK],T,hR,hM,hQ,hI,e)}hT.push([hM,hQ]);this._parseCacheGL[hN]=hT;this._parseCacheGL[hN].cacheIndex=hN;return hT},ifInMapView:function(){if(!this.map){return false}if(this.map.getZoom()<5){return true}if(this._config.clip===false){return true}var e=this.map.getBoundsIn();return !!e.intersects(this.getBoundsIn())},_getDisplayPixelsGLWithCut:function(e){return this._getDisplayPixelsGL(e)},_getDisplayPixelsGL:function(hI){var hK=this.map;var hJ=[];var hM=[];hJ.pointsArray=hM;if(hI.length==0||!this.isVisible()){return[hJ]}var hL=hI;if(!this._config.enableEditing&&this._config.enableParse){hL=this._simplification(hI)}var T=[];if(!this.hasMultipleParts){T[0]=this._toOverlayPixelsGL(hL)}else{for(var e=0;e<hL.length;e++){T.push(this._toOverlayPixelsGL(hL[e]))}}return T},_toOverlayPixelsGL:function(hP){var T=this.map;var hO=[];var hL=[];hO.pointsArray=hL;var e=T._polyOverlayBasePoint;var hN=[hP[0].lng-e.lng,hP[0].lat-e.lat];hO.push(hN);hL.push(hN[0],hN[1]);for(var hK=1,hJ=1,hI=hP.length;hK<hI;hK++){var hM=[hP[hK].lng-e.lng,hP[hK].lat-e.lat];if(hM[0]!==hO[hJ-1][0]||hM[1]!==hO[hJ-1][1]){hO.push(hM);hL.push(hM[0],hM[1]);hJ++}}return hO},getStrokeColorForGL:function(){var T=this._config.strokeColor.substr(1);var i=this._config.strokeOpacity;var e;if(T.length===3){e=[parseInt(T.substr(0,1)+T.substr(0,1),16),parseInt(T.substr(1,1)+T.substr(1,1),16),parseInt(T.substr(2,1)+T.substr(2,1),16),Math.floor(i*255)]}else{e=[parseInt(T.substr(0,2),16),parseInt(T.substr(2,2),16),parseInt(T.substr(4,2),16),Math.floor(i*255)]}return e},show:function(){cP.prototype.show.call(this);var e=new a6("onlineupdate");e.action="show";e.overlay=this;this.dispatchEvent(e);this.draw();if(this._config.enableEditing===true&&!this._config.geodesic){this.addVertexs()}},hide:function(){cP.prototype.hide.call(this);var e=new a6("onlineupdate");e.action="hide";e.overlay=this;this.dispatchEvent(e);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs()}},remove:function(){if(this.map){this.map.removeEventListener("onmousemove",this._graphMouseEvent);this.map.removeEventListener("onclick",this._graphClickEvent);this.map.removeEventListener("ondblclick",this._graphClickEvent);this.map.removeEventListener("onrightclick",this._graphClickEvent);this.map.removeEventListener("onrightdblclick",this._graphClickEvent)}cP.prototype.remove.call(this);this._clearCache();var e=new a6("onlineupdate");e.action="remove";e.overlay=this;this.fire(e);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs()}}});function cW(hK,hI,hR){var hO=false,hM=false,hP=false,hT=new eb(hK.x,hK.y),hS=new eb(hI.x,hI.y),hJ=e8(hT,hR),T=e8(hS,hR),hQ;var hV,hU;var hN=hR.minX,hL=hR.minY,i=hR.maxX,e=hR.maxY;do{if(hJ.all==0&&T.all==0){hO=true;hP=true}else{if((hJ.all&T.all)!=0){hP=true}else{if(hJ.all!=0){hQ=hJ}else{hQ=T}if(hQ.top){hV=hT.x+(hS.x-hT.x)*(hL-hT.y)/(hS.y-hT.y);hU=hL}else{if(hQ.bottom){hV=hT.x+(hS.x-hT.x)*(e-hT.y)/(hS.y-hT.y);hU=e}else{if(hQ.right){hU=hT.y+(hS.y-hT.y)*(i-hT.x)/(hS.x-hT.x);hV=i}else{if(hQ.left){hU=hT.y+(hS.y-hT.y)*(hN-hT.x)/(hS.x-hT.x);hV=hN}}}}hM=true;if(hQ.all==hJ.all){hT.x=Math.round(hV);hT.y=Math.round(hU);hJ=e8(hT,hR)}else{hS.x=Math.round(hV);hS.y=Math.round(hU);T=e8(hS,hR)}}}}while(!hP);if(hO){return{pixel0:new eb(hT.x,hT.y),pixel1:new eb(hS.x,hS.y),clip:hM?true:false}}}function e8(i,hJ){var T={top:0,bottom:0,right:0,left:0,all:0};var e=i.x,hI=i.y;if(hI<hJ.minY){T.top=8;T.all+=T.top}else{if(hI>hJ.maxY){T.bottom=4;T.all+=T.bottom}}if(e>hJ.maxX){T.right=2;T.all+=T.right}else{if(e<hJ.minX){T.left=1;T.all+=T.left}}return T}C.extend(a.prototype,{initialize:function(i){w.prototype.initialize.call(this,i);var e=this._config;this.setOptions({fillColor:"",strokeColor:e.strokeColor,strokeWeight:e.strokeWeight,strokeStyle:e.strokeStyle,strokeLineCap:e.strokeLineCap,strokeLineJoin:e.strokeLineJoin,strokeOpacity:e.strokeOpacity});return this.domElement},setPoints:function(hI){this._clearCache();this.points=w.getGraphPoints(hI).slice(0);if(this._config.geodesic===true){this.greatCirclePoints.length=0;for(var T=0;T<this.points.length-1;T++){this.calcGreatCirclePoints(this.points[T],this.points[T+1])}}this._calcBounds();this.draw();var e=new a6("onlineupdate");e.overlay=this;this.dispatchEvent(e)},_getDisplayPixels:function(hU,e,hZ){var h0=this.map;var hK=[];if(hU.length===0||!this.isVisible()){return[hK]}if(h0._renderType!=="webgl"&&!this.domElement){return[hK]}if(!((C.Platform.ipad||C.Platform.iphone||C.Platform.android)&&hU.length>5000)&&!this._config.enableEditing){var hL=this.getParseCacheIndex(h0.getZoom());if(this._parseCache[hL]){hU=this._parseCache[hL]}else{var T=hw(hU,this.getParseTolerance(h0.getZoom(),h0.config.coordType));hU=this._parseCache[hL]=T}}var hY;var h1=h0.pointToOverlayPixelIn(hU[0],{zoom:e,center:hZ});hK.push(h1);if(h1.onBack){hY=true}for(var hV=1,hS=1,hR=hU.length;hV<hR;hV++){var hJ=h0.pointToOverlayPixelIn(hU[hV],{zoom:e,center:hZ});if(hJ.onBack){hY=true}if(!hJ.equals(hK[hS-1])){hK.push(hJ);hS++}}var hX=[];var hP=Math.round(h0.offsetX);var hO=Math.round(h0.offsetY);if(h0._renderType==="webgl"){hP=hO=0}var hN=h0.config.drawMargin;var hM={minX:-hP-hN,minY:-hO-hN,maxX:-hP+hN+h0.width,maxY:-hO+hN+h0.height};for(hV=0,hR=hK.length-1;hV<hR;hV++){var hW=hK[hV];var hT=hK[hV+1];var hI=cW(hW,hT,hM);if(hI){hX.push(hI)}}var hQ=[[]];for(hV=0,hR=hX.length;hV<hR;hV++){if(hX[hV].clip){hQ[hQ.length-1].push(hX[hV].pixel0);hQ[hQ.length-1].push(hX[hV].pixel1);if(hX[hV+1]&&hX[hV+1].clip){hQ.push([])}}else{hQ[hQ.length-1].push(hX[hV].pixel0);if(hV===hX.length-1){hQ[hQ.length-1].push(hX[hV].pixel1)}}}hQ.isOnBack=hY;return hQ},_getDisplayPixelsGLWithCut:function(hS){var hX=this.map;var hK=[];if(hS.length===0||!this.isVisible()){return[hK]}if(!this._config.enableEditing){var hL=this.getParseCacheIndex(hX.getZoom());if(this._parseCache[hL]){hS=this._parseCache[hL]}else{var T=hw(hS,this.getParseTolerance(hX.getZoom(),hX.config.coordType));hS=this._parseCache[hL]=T}}var hY=hX._polyOverlayBasePoint;var e=hX.getZoomUnits();if(this._parseCacheGLRaw[hL]){hK=this._parseCacheGLRaw[hL]}else{var hZ=new eb(hS[0].lng-hY.lng,hS[0].lat-hY.lat);hK.push(hZ);for(var hT=1,hQ=1,hP=hS.length;hT<hP;hT++){var hJ=new eb(hS[hT].lng-hY.lng,hS[hT].lat-hY.lat);if(!hJ.equals(hK[hQ-1])){hK.push(hJ);hQ++}}this._parseCacheGLRaw[hL]=hK}var hW=hX.pixelToPointIn(new eb(0,hX.height));var hV=[];var hN=hX.config.drawMarginGL;var hM={minX:Math.round(-hN*e+(hW.lng-hY.lng)),minY:Math.round(-hN*e+(hW.lat-hY.lat)),maxX:Math.round((hN+hX.width)*e+(hW.lng-hY.lng)),maxY:Math.round((hN+hX.height)*e+(hW.lat-hY.lat))};for(hT=0,hP=hK.length-1;hT<hP;hT++){var hU=hK[hT];var hR=hK[hT+1];var hI=cW(hU,hR,hM);if(hI){hV.push(hI)}}var hO=[[]];for(hT=0,hP=hV.length;hT<hP;hT++){if(hV[hT].clip){hO[hO.length-1].push([hV[hT].pixel0.x,hV[hT].pixel0.y]);hO[hO.length-1].push([hV[hT].pixel1.x,hV[hT].pixel1.y]);if(hV[hT+1]&&hV[hT+1].clip){hO.push([])}}else{hO[hO.length-1].push([hV[hT].pixel0.x,hV[hT].pixel0.y]);if(hT===hV.length-1){hO[hO.length-1].push([hV[hT].pixel1.x,hV[hT].pixel1.y])}}}return hO},_getDisplayPixelsGL:function(hO){var T=this.map;var hN=[];if(hO.length===0||!this.isVisible()){return[hN]}if(this.greatCirclePoints.length>0){hO=this.greatCirclePoints}if(!this._config.enableEditing){var hM=this.getParseCacheIndex(T.getZoom());if(this._parseCache[hM]){hO=this._parseCache[hM]}else{var hP=hw(hO,this.getParseTolerance(T.getZoom(),T.config.coordType));hO=this._parseCache[hM]=hP}}var e=T._polyOverlayBasePoint;hN.push([hO[0].lng-e.lng,hO[0].lat-e.lat]);for(var hK=1,hJ=1,hI=hO.length;hK<hI;hK++){var hL=[hO[hK].lng-e.lng,hO[hK].lat-e.lat];if(hL[0]!==hN[hJ-1][0]||hL[1]!==hN[hJ-1][1]){hN.push(hL);hJ++}}hN=[hN];this._addMultipleDrawPath(hN);return hN},_addMultipleDrawPath:function(T,hK,i){if(this._config.clip===true){return}var hJ=this.map;hK=hK||hJ.getZoom();if(hK>12&&hJ.getRenderType()!=="webgl"){return}var e=i?hJ.worldSize(hK):c2.WORLD_SIZE_MC;var hI=T.slice(0);C.each(hI,function(hL){var hM=[];C.each(hL,function(hN){if(hN.x){hM.push(new eb(hN.x-e,hN.y))}else{hM.push([hN[0]-e,hN[1]])}});T.push(hM)});C.each(hI,function(hL){var hM=[];C.each(hL,function(hN){if(hN.x){hM.push(new eb(hN.x+e,hN.y))}else{hM.push([hN[0]+e,hN[1]])}});T.push(hM)})},getParsedPoints:function(){var hL=this.map;var i=this.points;var e=[];var T=this;var hK=i.slice(0);hK=[hK];if(this.greatCirclePoints.length>0){hK=[];hK[0]=this.greatCirclePoints}C.each(hK,function(hN){var hM=hw(hN,T.getParseTolerance(hL.getZoom(),hL.config.coordType));e.push(hM)});var hJ=0;if(this._bounds.sw.lng<-c2.WORLD_SIZE_MC_HALF){hJ=c2.WORLD_SIZE_MC}if(this._bounds.ne.lng>c2.WORLD_SIZE_MC_HALF){hJ=-c2.WORLD_SIZE_MC}if(hJ===0){return e}var hI=e.slice(0);C.each(hI,function(hM){var hN=[];C.each(hM,function(hO){hN.push(new hj(hO.lng+hJ,hO.lat))});e.push(hN)});return e},_onMarkerDragging:function(hO){this._editstate=true;var T=hO.currentTarget;var hQ=hO.point;var hP=T.index;var i=this.vertexPoints;var hR;var hM=null;var hI=null;if(hP===0){var hN=i[hP+2].p;hR=[hQ,hN];hM=new hj((hN.lng+hQ.lng)/2,(hN.lat+hQ.lat)/2);if(this.vertexMarkers[hP+1]){this.vertexMarkers[hP+1].hide()}}else{if(hP===i.length-1){var hL=i[hP-2].p;hR=[hL,hQ];hM=new hj((hL.lng+hQ.lng)/2,(hL.lat+hQ.lat)/2);if(this.vertexMarkers[hP-1]){this.vertexMarkers[hP-1].hide()}}else{var hL=i[hP-1].p;var hN=i[hP+1].p;hR=[hL,hQ,hN];if(!T.t){hL=i[hP-2].p;hN=i[hP+2].p;hR=[hL,hQ,hN];hM=new hj((hL.lng+hQ.lng)/2,(hL.lat+hQ.lat)/2);hI=new hj((hN.lng+hQ.lng)/2,(hN.lat+hQ.lat)/2);if(this.vertexMarkers[hP-1]){this.vertexMarkers[hP-1].hide()}if(this.vertexMarkers[hP+1]){this.vertexMarkers[hP+1].hide()}}}}if(!this._temp.dashedLine){var hK=new a(hR,{strokeStyle:"dashed",strokeColor:this._config.strokeColor,strokeWeight:this._config.strokeWeight,strokeOpacity:this._config.strokeOpacity});this.map.addOverlay(hK);hK.hide();this._temp.dashedLine=hK}else{this._temp.dashedLine.setPoints(hR);this._temp.dashedLine.show()}var hJ=new g2(eV.imgPath+"nodeT.gif",new d1(11,11),{offset:new d1(5,5)});if(!this._temp.preTNode&&hM){this._temp.preTNode=new dk(hM,{icon:hJ});this.map.addOverlay(this._temp.preTNode)}else{if(hM){this._temp.preTNode.setPoint(hM)}}if(!this._temp.nexTNode&&hI){this._temp.nexTNode=new dk(hI,{icon:hJ});this.map.addOverlay(this._temp.nexTNode)}else{if(hI){this._temp.nexTNode.setPoint(hI)}}}});C.extend(eh.prototype,{initialize:function(i){w.prototype.initialize.call(this,i);var e=this._config;this.setOptions({fillColor:"",strokeColor:e.strokeColor,strokeWeight:e.strokeWeight,strokeStyle:e.strokeStyle,strokeLineCap:e.strokeLineCap,strokeLineJoin:e.strokeLineJoin,strokeOpacity:e.strokeOpacity});return this.domElement},setPoints:function(i){this._clearCache();this.points=w.getGraphPoints(i).slice(0);this.points=this.calcBezierPoints(this.points,this._cps);this._calcBounds();this.draw();var e=new a6("onlineupdate");e.overlay=this;this.dispatchEvent(e)},_getDisplayPixels:function(hU,e,hZ){var h0=this.map;var hK=[];if(hU.length===0||!this.isVisible()){return[hK]}if(h0._renderType!=="webgl"&&!this.domElement){return[hK]}if(!((C.Platform.ipad||C.Platform.iphone||C.Platform.android)&&hU.length>5000)&&!this._config.enableEditing){var hL=this.getParseCacheIndex(h0.getZoom());if(this._parseCache[hL]){hU=this._parseCache[hL]}else{var T=hw(hU,this.getParseTolerance(h0.getZoom(),h0.config.coordType));hU=this._parseCache[hL]=T}}var hY;var h1=h0.pointToOverlayPixelIn(hU[0],{zoom:e,center:hZ});hK.push(h1);if(h1.onBack){hY=true}for(var hV=1,hS=1,hR=hU.length;hV<hR;hV++){var hJ=h0.pointToOverlayPixelIn(hU[hV],{zoom:e,center:hZ});if(hJ.onBack){hY=true}if(!hJ.equals(hK[hS-1])){hK.push(hJ);hS++}}var hX=[];var hP=Math.round(h0.offsetX);var hO=Math.round(h0.offsetY);if(h0._renderType==="webgl"){hP=hO=0}var hN=h0.config.drawMargin;var hM={minX:-hP-hN,minY:-hO-hN,maxX:-hP+hN+h0.width,maxY:-hO+hN+h0.height};for(hV=0,hR=hK.length-1;hV<hR;hV++){var hW=hK[hV];var hT=hK[hV+1];var hI=cW(hW,hT,hM);if(hI){hX.push(hI)}}var hQ=[[]];for(hV=0,hR=hX.length;hV<hR;hV++){if(hX[hV].clip){hQ[hQ.length-1].push(hX[hV].pixel0);hQ[hQ.length-1].push(hX[hV].pixel1);if(hX[hV+1]&&hX[hV+1].clip){hQ.push([])}}else{hQ[hQ.length-1].push(hX[hV].pixel0);if(hV===hX.length-1){hQ[hQ.length-1].push(hX[hV].pixel1)}}}hQ.isOnBack=hY;return hQ},_getDisplayPixelsGLWithCut:function(hS){var hX=this.map;var hK=[];if(hS.length===0||!this.isVisible()){return[hK]}if(!this._config.enableEditing){var hL=this.getParseCacheIndex(hX.getZoom());if(this._parseCache[hL]){hS=this._parseCache[hL]}else{var T=hw(hS,this.getParseTolerance(hX.getZoom(),hX.config.coordType));hS=this._parseCache[hL]=T}}var hY=hX._polyOverlayBasePoint;var e=hX.getZoomUnits();if(this._parseCacheGLRaw[hL]){hK=this._parseCacheGLRaw[hL]}else{var hZ=new eb(hS[0].lng-hY.lng,hS[0].lat-hY.lat);hK.push(hZ);for(var hT=1,hQ=1,hP=hS.length;hT<hP;hT++){var hJ=new eb(hS[hT].lng-hY.lng,hS[hT].lat-hY.lat);if(!hJ.equals(hK[hQ-1])){hK.push(hJ);hQ++}}this._parseCacheGLRaw[hL]=hK}var hW=hX.pixelToPointIn(new eb(0,hX.height));var hV=[];var hN=hX.config.drawMarginGL;var hM={minX:Math.round(-hN*e+(hW.lng-hY.lng)),minY:Math.round(-hN*e+(hW.lat-hY.lat)),maxX:Math.round((hN+hX.width)*e+(hW.lng-hY.lng)),maxY:Math.round((hN+hX.height)*e+(hW.lat-hY.lat))};for(hT=0,hP=hK.length-1;hT<hP;hT++){var hU=hK[hT];var hR=hK[hT+1];var hI=cW(hU,hR,hM);if(hI){hV.push(hI)}}var hO=[[]];for(hT=0,hP=hV.length;hT<hP;hT++){if(hV[hT].clip){hO[hO.length-1].push([hV[hT].pixel0.x,hV[hT].pixel0.y]);hO[hO.length-1].push([hV[hT].pixel1.x,hV[hT].pixel1.y]);if(hV[hT+1]&&hV[hT+1].clip){hO.push([])}}else{hO[hO.length-1].push([hV[hT].pixel0.x,hV[hT].pixel0.y]);if(hT===hV.length-1){hO[hO.length-1].push([hV[hT].pixel1.x,hV[hT].pixel1.y])}}}return hO},_getDisplayPixelsGL:function(hO){var T=this.map;var hN=[];if(hO.length===0||!this.isVisible()){return[hN]}if(this.greatCirclePoints.length>0){hO=this.greatCirclePoints}if(!this._config.enableEditing){var hM=this.getParseCacheIndex(T.getZoom());if(this._parseCache[hM]){hO=this._parseCache[hM]}else{var hP=hw(hO,this.getParseTolerance(T.getZoom(),T.config.coordType));hO=this._parseCache[hM]=hP}}var e=T._polyOverlayBasePoint;hN.push([hO[0].lng-e.lng,hO[0].lat-e.lat]);for(var hK=1,hJ=1,hI=hO.length;hK<hI;hK++){var hL=[hO[hK].lng-e.lng,hO[hK].lat-e.lat];if(hL[0]!==hN[hJ-1][0]||hL[1]!==hN[hJ-1][1]){hN.push(hL);hJ++}}hN=[hN];this._addMultipleDrawPath(hN);return hN},_addMultipleDrawPath:function(T,hK,i){if(this._config.clip===true){return}var hJ=this.map;hK=hK||hJ.getZoom();if(hK>12&&hJ.getRenderType()!=="webgl"){return}var e=i?hJ.worldSize(hK):c2.WORLD_SIZE_MC;var hI=T.slice(0);C.each(hI,function(hL){var hM=[];C.each(hL,function(hN){if(hN.x){hM.push(new eb(hN.x-e,hN.y))}else{hM.push([hN[0]-e,hN[1]])}});T.push(hM)});C.each(hI,function(hL){var hM=[];C.each(hL,function(hN){if(hN.x){hM.push(new eb(hN.x+e,hN.y))}else{hM.push([hN[0]+e,hN[1]])}});T.push(hM)})},});C.extend(fd.prototype,{setPoints:function(e){if(!e){return}this._clearCache();this.points=this._unifyArgs(e);if(this._config.geodesic===true){this.calcGreatCirclePoints(ef.convertMC2LL(this.points[0][0]),ef.convertMC2LL(this.points[0][1]))}this._calcBounds()},_getDisplayPixels:function(e,hL,hI){var hK=this.map;var T=[];var i=this;var hJ=e.slice(0);if(this.greatCirclePoints.length>0){hJ[0]=this.greatCirclePoints}C.each(hJ,function(hN,hM){var hO=i._getEachDisplayPixels(hN,hM,hL,hI);C.each(hO,function(hP){T.push(hP)})});this._addMultipleDrawPath(T,hL,true);return T},_addMultipleDrawPath:function(T,hK,i){if(this._config.clip===true){return}var hJ=this.map;hK=hK||hJ.getZoom();if(hK>12&&hJ.getRenderType()!=="webgl"){return}var e=i?hJ.worldSize(hK):c2.WORLD_SIZE_MC;var hI=T.slice(0);C.each(hI,function(hL){var hM=[];C.each(hL,function(hN){if(hN.x){hM.push(new eb(hN.x-e,hN.y))}else{hM.push([hN[0]-e,hN[1]])}});T.push(hM)});C.each(hI,function(hL){var hM=[];C.each(hL,function(hN){if(hN.x){hM.push(new eb(hN.x+e,hN.y))}else{hM.push([hN[0]+e,hN[1]])}});T.push(hM)})},_getDisplayPixelsGL:function(e){var T=[];var i=this;var hI=e.slice(0);if(this.greatCirclePoints.length>0){hI[0]=this.greatCirclePoints}C.each(hI,function(hK,hJ){var hL=i._getEachDisplayPixelsGL(hK,hJ);C.each(hL,function(hM){T.push(hM)})});this._addMultipleDrawPath(T);return T},_getEachDisplayPixels:function(hS,hM,hL,hP){var e=this.map;var hR=[];if(hS.length===0||!this.domElement||!this.isVisible()){return[hR]}hS=this._simplification(hS,hM);var hQ;var hO=e.pointToOverlayPixelIn(hS[0],{zoom:hL,center:hP});hR.push(hO);if(hO.onBack){hQ=true}for(var hK=1,hI=1,T=hS.length;hK<T;hK++){var hN=e.pointToOverlayPixelIn(hS[hK],{zoom:hL,center:hP});if(hN.onBack){hQ=true}if(!hN.equals(hR[hI-1])){hR.push(hN);hI++}}if(e.getZoom()<5||this._config.clip===false){return[hR]}var hJ=this._clipLine(hR);hJ.isOnBack=hQ;return hJ},_simplification:function(T,i){if(this._config.enableEditing){return T}var hJ=this.map;var hI=this.getParseCacheIndex(hJ.getZoom());if(this._parseCache[hI]&&this._parseCache[hI][i]){return this._parseCache[hI][i]}else{var e=hw(T,this.getParseTolerance(hJ.getZoom(),hJ.config.coordType));if(!this._parseCache[hI]){this._parseCache[hI]=[]}this._parseCache[hI][i]=e;return e}},_clipLine:function(hI){var e=this.map;var hO=[];var hR=Math.round(e.offsetX);var hQ=Math.round(e.offsetY);var hS=e.config.drawMargin;var hK={minX:-hR-hS,minY:-hQ-hS,maxX:-hR+hS+e.width,maxY:-hQ+hS+e.height};for(var hL=0,T=hI.length-1;hL<T;hL++){var hN=hI[hL];var hM=hI[hL+1];var hP=cW(hN,hM,hK);if(hP){hO.push(hP)}}var hJ=[[]];for(var hL=0,T=hO.length;hL<T;hL++){if(hO[hL].clip){hJ[hJ.length-1].push(hO[hL].pixel0);hJ[hJ.length-1].push(hO[hL].pixel1);if(hO[hL+1]&&hO[hL+1].clip){hJ.push([])}}else{hJ[hJ.length-1].push(hO[hL].pixel0);if(hL===hO.length-1){hJ[hJ.length-1].push(hO[hL].pixel1)}}}return hJ},_getEachDisplayPixelsGL:function(hO,hL){var T=this.map;var hN=[];if(hO.length===0||!this.isVisible()){return[hN]}hO=this._simplification(hO,hL);if(this._config.clip===true){return this._clipLineGL(hO,hL)}var e=T._polyOverlayBasePoint;hN.push([hO[0].lng-e.lng,hO[0].lat-e.lat]);for(var hK=1,hJ=1,hI=hO.length;hK<hI;hK++){var hM=[hO[hK].lng-e.lng,hO[hK].lat-e.lat];if(hM[0]!==hN[hJ-1][0]||hM[1]!==hN[hJ-1][1]){hN.push(hM);hJ++}}return[hN]},_clipLineGL:function(hS,hL){var hX=this.map;var hK=this.getParseCacheIndex(hX.getZoom());var hY=hX._polyOverlayBasePoint;var hJ=[];if(this._parseCacheGLRaw[hK]&&this._parseCacheGLRaw[hK][hL]){hJ=this._parseCacheGLRaw[hK][hL]}else{var hZ=new eb(hS[0].lng-hY.lng,hS[0].lat-hY.lat);hJ.push(hZ);for(var hT=1,hQ=1,hP=hS.length;hT<hP;hT++){var hI=new eb(hS[hT].lng-hY.lng,hS[hT].lat-hY.lat);if(!hI.equals(hJ[hQ-1])){hJ.push(hI);hQ++}}if(!this._parseCacheGLRaw[hK]){this._parseCacheGLRaw[hK]=[]}this._parseCacheGLRaw[hK][hL]=hJ}var e=hX.getZoomUnits();var hW=hX.pixelToPointIn(new eb(0,hX.height));var hV=[];var hN=hX.config.drawMarginGL;var hM={minX:Math.round(-hN*e+(hW.lng-hY.lng)),minY:Math.round(-hN*e+(hW.lat-hY.lat)),maxX:Math.round((hN+hX.width)*e+(hW.lng-hY.lng)),maxY:Math.round((hN+hX.height)*e+(hW.lat-hY.lat))};for(hT=0,hP=hJ.length-1;hT<hP;hT++){var hU=hJ[hT];var hR=hJ[hT+1];var T=cW(hU,hR,hM);if(T){hV.push(T)}}var hO=[[]];for(hT=0,hP=hV.length;hT<hP;hT++){if(hV[hT].clip){hO[hO.length-1].push([hV[hT].pixel0.x,hV[hT].pixel0.y]);hO[hO.length-1].push([hV[hT].pixel1.x,hV[hT].pixel1.y]);if(hV[hT+1]&&hV[hT+1].clip){hO.push([])}}else{hO[hO.length-1].push([hV[hT].pixel0.x,hV[hT].pixel0.y]);if(hT===hV.length-1){hO[hO.length-1].push([hV[hT].pixel1.x,hV[hT].pixel1.y])}}}return hO},getParsedPoints:function(){var hL=this.map;var i=this.points;var e=[];var T=this;var hK=i.slice(0);if(this.greatCirclePoints.length>0){hK[0]=this.greatCirclePoints}C.each(hK,function(hN){var hM=hw(hN,T.getParseTolerance(hL.getZoom(),hL.config.coordType));e.push(hM)});var hJ=0;if(this._bounds.sw.lng<-c2.WORLD_SIZE_MC_HALF){hJ=c2.WORLD_SIZE_MC}if(this._bounds.ne.lng>c2.WORLD_SIZE_MC_HALF){hJ=-c2.WORLD_SIZE_MC}if(hJ===0){return e}var hI=e.slice(0);C.each(hI,function(hM){var hN=[];C.each(hM,function(hO){hN.push(new hj(hO.lng+hJ,hO.lat))});e.push(hN)});console.log(e);return e},setPointAt:function(T,e,hI){hI=hI||0;if(!e||!this.points[hI][T]||!this.points[hI][T]){return}this._clearCache();this.points[hI][T]=new hj(e.lng,e.lat);if(this._config.geodesic===true){this.calcGreatCirclePoints(ef.convertMC2LL(this.points[hI][0]),ef.convertMC2LL(this.points[hI][1]))}this._calcBounds();this.draw();var i=new a6("onlineupdate");i.overlay=this;this.dispatchEvent(i)},calcGreatCirclePoints:function(hI,T){if(hI.equals(T)){return}var e=ef.getDistance(dE(hI.lng),dE(hI.lat),dE(T.lng),dE(T.lat));if(e<250000){return}this.greatCirclePoints.length=0;var hM=Math.round(e/150000);var hQ=this.calcAngularDistance(hI,T);this.greatCirclePoints.push(this.points[0][0]);var hP=hI.lng;var hO=this.points[0][0];for(var hJ=0;hJ<hM;hJ++){var hL=this.calcMiddlePoint(hI,T,hJ/hM,hQ);var hN=ef.convertLL2MC(hL);var hK=hN.lng;var hR=bK(hN,hO);if(hR>30037726){if(hN.lng<hO.lng){hN.lng+=c2.WORLD_SIZE_MC}else{hN.lng-=c2.WORLD_SIZE_MC}}this.greatCirclePoints.push(hN);hO=hN}this.greatCirclePoints.push(this.points[0][1]);var hR=bK(this.points[0][1],hO);if(hR>30037726){if(this.points[0][1].lng<hO.lng){this.points[0][1].lng+=c2.WORLD_SIZE_MC}else{this.points[0][1].lng-=c2.WORLD_SIZE_MC}}},calcMiddlePoint:function(hP,hO,hQ,hU){var hJ=hP.lat;var hI=hO.lat;var hT=hP.lng;var hR=hO.lng;var hV=dE(hJ);var hS=dE(hI);var i=dE(hT);var e=dE(hR);var hX=Math.sin((1-hQ)*hU)/Math.sin(hU);var hW=Math.sin(hQ*hU)/Math.sin(hU);var hM=hX*Math.cos(hV)*Math.cos(i)+hW*Math.cos(hS)*Math.cos(e);var hL=hX*Math.cos(hV)*Math.sin(i)+hW*Math.cos(hS)*Math.sin(e);var hK=hX*Math.sin(hV)+hW*Math.sin(hS);var T=Math.atan2(hK,Math.sqrt(Math.pow(hM,2)+Math.pow(hL,2)));var hN=Math.atan2(hL,hM);return new hj(c8(hN),c8(T))},calcAngularDistance:function(hJ,i){var hK=dE(hJ.lat);var hI=dE(i.lat);var T=dE(hJ.lng);var e=dE(i.lng);return Math.acos(Math.sin(hK)*Math.sin(hI)+Math.cos(hK)*Math.cos(hI)*Math.cos(Math.abs(e-T)))}});C.extend(aM.prototype,{initialize:function(i){w.prototype.initialize.call(this,i);var e=this._config;this.setOptions({strokeColor:e.strokeColor,strokeWeight:e.strokeWeight,strokeStyle:e.strokeStyle,fillColor:e.fillColor,strokeOpacity:e.strokeOpacity,fillOpacity:e.fillOpacity});return this.domElement},setPointAt:function(T,e){if(!this._userPoints[T]){return}this._clearCache();this._userPoints[T]=new hj(e.lng,e.lat);this.points[T]=new hj(e.lng,e.lat);if(T===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new hj(e.lng,e.lat)}this._calcBounds();this.draw();var i=new a6("onlineupdate");i.overlay=this;this.dispatchEvent(i)},setPositionAt:function(i,e){if(!this._userPoints[i]){return}var T=ef.convertLL2MC(e);this.setPointAt(i,T);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs();this.addVertexs()}},_onMarkerDragging:function(hP){this._editstate=true;var hI=hP.currentTarget;var hR=hP.point;var hQ=hI.index;var i=this.vertexPoints;var hT;var hM=i[2].p;var hS=i[i.length-2].p;var hN=null;var T=null;if(hQ===0){var hO=i[hQ+2].p;hT=[hS,hR,hO];if(!hI.t){hN=new hj((hS.lng+hR.lng)/2,(hS.lat+hR.lat)/2);T=new hj((hO.lng+hR.lng)/2,(hO.lat+hR.lat)/2)}}else{if(hQ===i.length-1){var hL=i[hQ-2].p;hT=[hL,hR,hM];if(!hI.t){hN=new hj((hL.lng+hR.lng)/2,(hL.lat+hR.lat)/2);T=new hj((hM.lng+hR.lng)/2,(hM.lat+hR.lat)/2)}}else{var hL=i[hQ-1].p;var hO=i[hQ+1].p;hT=[hL,hR,hO];if(!hI.t){hL=i[hQ-2].p;hO=i[hQ+2].p;hT=[hL,hR,hO];hN=new hj((hL.lng+hR.lng)/2,(hL.lat+hR.lat)/2);T=new hj((hO.lng+hR.lng)/2,(hO.lat+hR.lat)/2);if(this.vertexMarkers[hQ-1]){this.vertexMarkers[hQ-1].hide()}if(this.vertexMarkers[hQ+1]){this.vertexMarkers[hQ+1].hide()}}}}if(!this._temp.dashedLine){var hK=new a(hT,{strokeStyle:"dashed",strokeColor:this._config.strokeColor,strokeWeight:this._config.strokeWeight,strokeOpacity:this._config.strokeOpacity});this.map.addOverlay(hK);this._temp.dashedLine=hK}else{this._temp.dashedLine.setPoints(hT)}var hJ=new g2(eV.imgPath+"nodeT.gif",new d1(11,11),{offset:new d1(5,5)});if(!this._temp.preTNode&&hN){this._temp.preTNode=new dk(hN,{icon:hJ});this.map.addOverlay(this._temp.preTNode)}else{if(hN){this._temp.preTNode.setPoint(hN)}}if(!this._temp.nexTNode&&T){this._temp.nexTNode=new dk(T,{icon:hJ});this.map.addOverlay(this._temp.nexTNode)}else{if(T){this._temp.nexTNode.setPoint(T)}}},getFillStyleForGL:function(){var T=this._config.fillColor.substr(1);var e=this._config.fillOpacity;var i;if(T.length===3){i=[parseInt(T.substr(0,1)+T.substr(0,1),16),parseInt(T.substr(1,1)+T.substr(1,1),16),parseInt(T.substr(2,1)+T.substr(2,1),16),e]}else{i=[parseInt(T.substr(0,2),16),parseInt(T.substr(2,2),16),parseInt(T.substr(4,2),16),e]}this._fillStyleInfoForGL=i.join(",");return this._fillStyleInfoForGL},buildFillVertex:function(hL){var hP=[];var hN=this.getParseCacheIndex(this.map.getZoom());if(this._areaCacheGL[hN]){return this._areaCacheGL[hN]}var hO=this._getDisplayPixelsGL(this.points);if(hO.pointsArray&&hO.pointsArray.length<3){this._areaCacheGL[hN]=[[],hP];return this._areaCacheGL[hN]}var hJ;var hK=[];var hI=0;for(var T=0;T<hO.length;T++){if(T>0){hI+=hO[T-1].length}hJ=hL(hO[T].pointsArray,null,null,hI);for(var e=0,hM=hJ.length;e<hM;e+=3){hP.push(hJ[e],hJ[e+1],hJ[e+2])}hK=hK.concat(hO[T].pointsArray)}var hQ=[new Float32Array(hK),new Uint16Array(hP)];this._areaCacheGL[hN]=hQ;return hQ}});C.extend(fZ.prototype,{initialize:function(e){aM.prototype.initialize.call(this,e);this.points=this._getPerimeterPoints(this.point,this.radius);this._calcBounds();return this.domElement},_addDom:function(){if(this.map._renderType==="webgl"){return}var e=this._drawer=br.getDrawer(this.map);this.domElement=e.addStandardCircle()},draw:function(i){if(!this.domElement){return}i=i||{};var T=this.getDisplayGeometry(i.center,i.zoom);if(this._drawer){this._drawer.setStandardCircleGeometry(this.domElement,T)}},getDisplayGeometry:function(e,i){var T=this.map.pointToOverlayPixelIn(this.point,{zoom:i,center:e});var hJ=Math.round(this._radiusMercator/this.map.getZoomUnits(i));var hI={cx:T.x,cy:T.y,radius:hJ};return hI},setPoint:function(e,T){if(!e){return}this._clearCache();if(!T){this.vertexPoints=null}this.point=e;this.latLng=ef.convertMC2LL(e);this.points=this._getPerimeterPoints(e,this.radius);this._calcBounds();this.draw();var i=new a6("onlineupdate");i.overlay=this;this.dispatchEvent(i)},setRadius:function(e,T){this._clearCache();if(!T){this.vertexPoints=null}this.radius=Math.abs(e);this.points=this._getPerimeterPoints(this.point,this.radius);this._calcBounds();this.draw();var i=new a6("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getParseTolerance:function(i,e){if(this._config.getParseTolerance){return this._config.getParseTolerance(i,e)}return fZ.parseTolerance[e][this.getParseCacheIndex(i)]},_onMarkerDragging:function(hL){var hJ;var hN;var hO;var i=this.map;this._editstate=true;var hI=hL.currentTarget;var hM=hI.index;var T=this.vertexPoints;var hK=T[0].p;var hP=T[T.length-1].p;if(hM==0){hN=hI.point;hO=hP}else{hN=hK;hO=hI.point}hJ=ef.getDistanceByMC(hN,hO);this.setRadius(hJ,true);this.setCenterIn(hN,true)},_onMarkerDragend:function(hJ){this._editstate=false;var hI=hJ.currentTarget;var T=hI.index;this.vertexPoints[0]={p:this.point,t:0};if(T==1){this.vertexPoints[1]={p:hI.point,t:0}}this.clearVertexs();this.addVertexs();var i=new a6("oneditend");i.pixel=hJ.pixel;i.point=hJ.point;i.latLng=hJ.latLng;i.overlay=this;this.dispatchEvent(i)},getVertexPoints:function(){if(!this.vertexPoints){var e=[];e.push({p:this.point,t:0});e.push({p:this.points[Math.floor(this.points.length*3/4)],t:0});this.vertexPoints=e}return this.vertexPoints}});C.extend(bn.prototype,{initialize:function(i){w.prototype.initialize.call(this,i);var e=this._config;this.setOptions({topFillColor:e.topFillColor,topFillOpacity:e.topFillOpacity,sideFillColor:e.sideFillColor,sideFillOpacity:e.sideFillOpacity,altitude:e.altitude});return this.domElement},setPointAt:function(T,e){if(!this._userPoints[T]){return}this._clearCache();this._userPoints[T]=new hj(e.lng,e.lat);this.points[T]=new hj(e.lng,e.lat);if(T===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new hj(e.lng,e.lat)}this._calcBounds();this.draw();var i=new a6("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getFillStyleForGL:function(){var i=this._config.topFillColor.substr(1);var hJ=this._config.topFillOpacity;var T=this._config.sideFillColor.substr(1);var hI=this._config.sideFillOpacity;var e;var hK;if(i.length===3){e=[parseInt(i.substr(0,1)+i.substr(0,1),16),parseInt(i.substr(1,1)+i.substr(1,1),16),parseInt(i.substr(2,1)+i.substr(2,1),16),hJ*255]}else{e=[parseInt(i.substr(0,2),16),parseInt(i.substr(2,2),16),parseInt(i.substr(4,2),16),hJ*255]}if(T.length===3){hK=[parseInt(T.substr(0,1)+T.substr(0,1),16),parseInt(T.substr(1,1)+T.substr(1,1),16),parseInt(T.substr(2,1)+T.substr(2,1),16),hI*255]}else{hK=[parseInt(T.substr(0,2),16),parseInt(T.substr(2,2),16),parseInt(T.substr(4,2),16),hI*255]}return{top:e,side:hK}},buildFillVertex:function(hK,h4){var hJ=this.getParseCacheIndex(this.map.getZoom());if(this._areaCacheGL[hJ]&&!h4){return this._areaCacheGL[hJ]}var h7=this._getDisplayPixelsGL(this.points);if(h7.pointsArray&&h7.pointsArray.length<3){this._areaCacheGL[hJ]={vertex:[],index:[]};return this._areaCacheGL[hJ]}var h2=this.getFillStyleForGL();var hV=h2.top;var hZ=h2.side;var hO=this._config.altitude;var ib=[0,0,1];var hQ=[];var T=[];var h1=0;for(var h5=0;h5<h7.length;h5++){if(h5>0){h1+=(h7[h5-1].length-1)*5}var hY=h7[h5].pointsArray;hY.splice(-2,2);var ic=this.getClockwise(hY);if(ic){hY=this.rev(hY)}for(var h8=0;h8<hY.length;h8+=2){hQ.push([hY[h8],hY[h8+1],hO,ib[0],ib[1],ib[2],hV[0],hV[1],hV[2],hV[3]])}var e=hK(hY,null,null,h1);for(var h8=0,hT=e.length;h8<hT;h8+=3){T.push(e[h8],e[h8+1],e[h8+2])}for(var h8=0,h0=hY.length;h8<h0;h8+=2){var hP=hY[h8];var hN=hY[h8+1];var hX=[hP,hN,0];var hW=[hP,hN,hO];var hI=h8+2;var hM=h8+3;if(h8===h0-2){hI=0;hM=1}var ia=hY[hI];var h9=hY[hM];var hU=[ia,h9,0];var hS=[ia,h9,hO];var h6=[hU[0]-hX[0],hU[1]-hX[1],hU[2]-hX[2]];var h3=[hW[0]-hX[0],hW[1]-hX[1],hW[2]-hX[2]];var ib=[];vec3.cross(ib,h6,h3);hX.push(ib[0],ib[1],ib[2]);hW.push(ib[0],ib[1],ib[2]);hU.push(ib[0],ib[1],ib[2]);hS.push(ib[0],ib[1],ib[2]);hX.push(hZ[0],hZ[1],hZ[2],hZ[3]);hW.push(hZ[0],hZ[1],hZ[2],hZ[3]);hU.push(hZ[0],hZ[1],hZ[2],hZ[3]);hS.push(hZ[0],hZ[1],hZ[2],hZ[3]);var hL=hQ.length;hQ.push(hX);hQ.push(hW);hQ.push(hU);hQ.push(hS);T.push(hL,hL+2,hL+3,hL,hL+3,hL+1)}}var hR={vertex:this.convertBuilding3dToTypedArray(hQ),index:new Uint16Array(T)};this._areaCacheGL[hJ]=hR;return hR},getClockwise:function(hO){var hK=hO.length;if(hK<6){return false}var hI=hO[hK-2];var hN=hO[hK-1];var T=hO[0];var hM=hO[1];var e=hO[2];var hL=hO[3];for(var hJ=2;hJ<hK;hJ+=2){if(hO[hJ]>T){hI=hO[hJ-2];hN=hO[hJ-1];T=hO[hJ];hM=hO[hJ+1];if(hJ+2>=hK){e=hO[0];hL=hO[1]}else{e=hO[hJ+2];hL=hO[hJ+3]}}}return((T-hI)*(hL-hM)-(hM-hN)*(e-T)<0)},rev:function(hI){var e=[];for(var T=hI.length-1;T>=0;T-=2){e[hI.length-1-T]=hI[T-1];e[hI.length-1-T+1]=hI[T]}return e},convertBuilding3dToTypedArray:function(hL){var T=hL.length;var hI=new Float32Array(T*7);var hK=new DataView(hI.buffer);var e=0;for(var hJ=0;hJ<hL.length;hJ++){e=hJ*7;hI[e+0]=hL[hJ][0];hI[e+1]=hL[hJ][1];hI[e+2]=hL[hJ][2];hI[e+3]=hL[hJ][3];hI[e+4]=hL[hJ][4];hI[e+5]=hL[hJ][5];hK.setUint8(e*4+24,hL[hJ][6]);hK.setUint8(e*4+25,hL[hJ][7]);hK.setUint8(e*4+26,hL[hJ][8]);hK.setUint8(e*4+27,hL[hJ][9])}return hI}});function cQ(e){this._map=e;this._canvasAttrName={strokeweight:"lineWidth",strokecolor:"strokeStyle",fillcolor:"fillStyle",strokeopacity:"globalAlpha",fillopacity:"globalAlpha"};this._type="canvas"}cQ.prototype=new dP();var bW=cQ.prototype;bW.addLine=function(){var i=S("canvas");this._map.getPanes().mapPane.appendChild(i);i.style.position="absolute";var e=i.getContext("2d");e.lineCap="round";e.lineJoin="round";e.save();return i};bW.setPath=function(T,i){if(!T){return}var e=T.getContext("2d");this._setCanvasPosition(T);this._clearCanvas(e);var hJ=parseInt(T.style.top);var hI=parseInt(T.style.left);e.beginPath();C.each(i,function(hM){if(hM.length===0){return}e.moveTo(hM[0].x-hI,hM[0].y-hJ);for(var hL=1,hK=hM.length;hL<hK;hL++){e.lineTo(hM[hL].x-hI,hM[hL].y-hJ)}});this._drawCanvas(T)};bW.setAttribute=function(hI,i,hJ){if(!hI){return}var e=hI.getContext("2d");var T=this._getAttributeName(i);if(T){e[T]=hJ}hI.setAttribute("_"+i,hJ||"");e.save();this._clearCanvas(e);this._drawCanvas(hI)};bW._getAttributeName=function(e){return this._canvasAttrName[e]||e};bW._setCanvasPosition=function(hJ){var i=this._map;var hO=i.config.drawMargin;var T=i.width+2*hO;var hL=i.height+2*hO;var hI=-i.offsetX-hO;var hK=-i.offsetY-hO;var hN=hJ.getContext("2d");var hM={strokeStyle:hN.strokeStyle,fillStyle:hN.fillStyle,globalAlpha:hN.globalAlpha,lineWidth:hN.lineWidth,lineCap:"round",lineJoin:"round"};hJ.setAttribute("width",T);hJ.setAttribute("height",hL);for(var e in hM){hN[e]=hM[e]}hN.save();var hP=hJ.style;hP.top=hK+"px";hP.left=hI+"px"};bW._clearCanvas=function(e){e.clearRect(0,0,9999,9999)};bW._drawCanvas=function(i){var e=i.getContext("2d");e.globalAlpha=i.getAttribute("_fillopacity");if(e.globalAlpha!=0&&i.getAttribute("_fillcolor")){e.fill()}e.globalAlpha=i.getAttribute("_strokeopacity");if(e.globalAlpha!==0&&i.getAttribute("_strokecolor")){e.stroke()}};bW.addStandardCircle=function(){var i=S("canvas");this._map.getPanes().mapPane.appendChild(i);i.style.position="absolute";var e=i.getContext("2d");e.lineCap="round";e.lineJoin="round";e.save();return i};bW.setStandardCircleGeometry=function(hI,hL){if(!hI){return}var T=hI.getContext("2d");this._setCanvasPosition(hI);this._clearCanvas(T);var hK=parseInt(hI.style.top);var hJ=parseInt(hI.style.left);var i=hL.cx-hJ;var hM=hL.cy-hK;var e=hL.radius;T.beginPath();T.arc(i,hM,e,0,Math.PI*2);this._drawCanvas(hI)};function dP(){}DrawerPrototype=dP.prototype;DrawerPrototype.setPalette=function(){};DrawerPrototype.addLine=function(){throw"addLineæ¥å£æ²¡æå®ç°"};DrawerPrototype.setAttribute=function(){throw"setAttributeæ¥å£æ²¡æå®ç°"};DrawerPrototype.setPath=function(){throw"setPathæ¥å£æ²¡æå®ç°"};DrawerPrototype.getType=function(){return this._type};var br={getDrawer:function(e){if(e._renderType==="webgl"){return null}if(!br["_"+e.hashCode]){br["_"+e.hashCode]={}}switch(e.config.drawer){case BMAP_SVG_DRAWER:return br.getSvgDrawer(e);case BMAP_VML_DRAWER:return br.getVmlDrawer(e);case BMAP_CANVAS_DRAWER:return br.getCanvasDrawer(e);default:break}if(br.isSupportSvg()){return br.getSvgDrawer(e)}if(br.isSupportVml()){return br.getVmlDrawer(e)}if(br.isSupportCanvas()){return br.getCanvasDrawer(e)}},getSvgDrawer:function(e){if(!br["_"+e.hashCode]._svgDrawer){br["_"+e.hashCode]._svgDrawer=new fM(e)}return br["_"+e.hashCode]._svgDrawer},getVmlDrawer:function(e){if(!br["_"+e.hashCode]._vmlDrawer){br["_"+e.hashCode]._vmlDrawer=new ho(e)}return br["_"+e.hashCode]._vmlDrawer},getCanvasDrawer:function(e){if(!br["_"+e.hashCode]._canvasDrawer){br["_"+e.hashCode]._canvasDrawer=new cQ(e)}return br["_"+e.hashCode]._canvasDrawer},isSupportVml:function(){if(typeof br.supportVml!="undefined"){return br.supportVml}var T=document.body.appendChild(S("div"));T.innerHTML=\'<v:shape id="vml_tester1" adj="1" />\';var i=T.firstChild;if(!i.style){return false}i.style.behavior="url(#default#VML)";var e=i?typeof i.adj=="object":true;T.parentNode.removeChild(T);br.supportVml=e;return e},isSupportSvg:function(){if(typeof br.supportSvg=="undefined"){br.supportSvg=!!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.1")}return br.supportSvg},isSupportCanvas:function(){if(typeof br.supportCanvas=="undefined"){br.supportCanvas=!!S("canvas").getContext}return br.supportCanvas}};bj.DrawerSelector=br;function fM(e){this._map=e;this.SVG_NS="http://www.w3.org/2000/svg";this._svgAttrName={strokeweight:"stroke-width",strokecolor:"stroke",fillcolor:"fill",strokeopacity:"stroke-opacity",fillopacity:"fill-opacity",strokestyle:"stroke-dasharray",strokelinecap:"stroke-linecap",strokelinejoin:"stroke-linejoin"};this._svg=this._createSvg();this._type="svg"}fM.prototype=new dP();var by=fM.prototype;by._createSvg=function(){var e=this._svg=S("svg",{},this.SVG_NS);e.setAttribute("version","1.1");e.setAttribute("type","system");var i=e.style;i.position="absolute";i.MozUserSelect="none";this.setPalette();this._map.getPanes().mapPane.appendChild(e);return e};by.setPalette=function(){if(!this._svg){return}var T=this._svg;var hM=this._map;var i=hM.config.drawMargin;var hJ=hM.width+2*i;var e=hM.height+2*i;var hL=-hM.offsetX-i;var hK=-hM.offsetY-i;this.setAttribute(T,"x",hJ+"px");this.setAttribute(T,"y",e+"px");this.setAttribute(T,"viewBox",hL+" "+hK+" "+hJ+" "+e);var hI=T.style;hI.top=hK+"px";hI.left=hL+"px";hI.width=hJ+"px";hI.height=e+"px"};by.getPalette=function(){return this._svg};by.setAttribute=function(hJ,T,hK,hI,i){if(!hJ){return}if(T==="strokestyle"){i=i||{};var hI=i.strokeWeight||4;var e=i.dashArray||null;switch(hK){case"dashed":if(e){hK=e.join(",")}else{hK=hI*2}break;case"dotted":if(i.strokeLineCap==="round"){hK="1,"+2*hI}else{hK=hI}break;default:hK=0;break}}var hL=hK||"none";if(hK===0){hL=0}hJ.setAttributeNS(null,this._getAttributeName(T),hL);return hJ};by._getAttributeName=function(e){return this._svgAttrName[e]||e};by.addLine=function(){var e=S("path",{},this.SVG_NS);this.setAttribute(e,"fill-rule","evenodd");this._svg.appendChild(e);return e};by.setPath=function(T,e){var i=this._getPathString(e)||"M -9999,-9999";this.setAttribute(T,"d",i)};by._getPathString=function(e){if(e.length===0){return""}var i=[];C.each(e,function(hJ){if(hJ.length<2){return}i.push("M "+hJ[0].x+" "+hJ[0].y+" L");for(var hI=1,T=hJ.length;hI<T;hI++){i.push(hJ[hI].x);i.push(hJ[hI].y)}});return i.join(" ")};by.addStandardCircle=function(){var e=S("circle",{},this.SVG_NS);this._svg.appendChild(e);return e};by.setStandardCircleGeometry=function(T,hI){var i=hI.cx;var hJ=hI.cy;var e=hI.radius;this.setAttribute(T,"cx",i);this.setAttribute(T,"cy",hJ);this.setAttribute(T,"r",e)};function ho(e){this._map=e;this._vmlAttrName={strokeweight:"weight",strokecolor:"color",fillcolor:"color",strokeopacity:"opacity",fillopacity:"opacity",strokestyle:"dashstyle"};this._type="vml"}ho.prototype=new dP();var bc=ho.prototype;bc.setAttribute=function(T,e,hI){if(T){if(e.indexOf("stroke")==0){T=T.getElementsByTagName("stroke")[0]}else{if(e.indexOf("fill")==0){T=T.getElementsByTagName("fill")[0]}}if(e.indexOf("color")>0){if(!hI){T.on=false}else{T.on=true}}if(e=="strokestyle"){switch(hI){case"dashed":hI="4 2 1 2";break;case"dotted":hI="1 1";break;default:hI="solid";break}}if(e=="strokeweight"){hI=hI+"px"}var i=this._getAttributeName(e);T[i]=hI||""}};bc._getAttributeName=function(e){return this._vmlAttrName[e]||e};bc.addLine=function(){var e=[\'<v:shape style="behavior:url(#default#VML);z-index:1;width:1px;height:1px;position:absolute;left:0;top:0;"\',\'coordsize="1,1" coordorigin="0,0" filled="t" fillcolor="white">\',\'<v:stroke style="behavior:url(#default#VML);" endcap="round" oned="true" />\',\'<v:fill style="behavior:url(#default#VML);" />\',"</v:shape>"].join("");return dC(this._map.getPanes().mapPane,e)};bc.setPath=function(i,e){this.setAttribute(i,"path",this._getPathString(e));if(C.Browser.ie==6){i.style.display="none";i.style.display=""}};bc._getPathString=function(e){if(e.length==0){return""}var i=[];C.each(e,function(hJ){if(hJ.length<2){return}i.push("m "+hJ[0].x+" "+hJ[0].y+" l");for(var hI=1,T=hJ.length;hI<T;hI++){i.push(hJ[hI].x);i.push(hJ[hI].y)}i.push("e")});return i.join(" ")||" "};bc.addStandardCircle=function(){var e=[\'<v:oval style="behavior:url(#default#VML);z-index:1;width:1px;height:1px;position:absolute;left:0;top:0;">\',\'<v:stroke style="behavior:url(#default#VML);" endcap="round" oned="true" />\',\'<v:fill style="behavior:url(#default#VML);" />\',"</v:oval>"].join("");return dC(this._map.getPanes().mapPane,e)};bc.setStandardCircleGeometry=function(T,hI){var i=hI.cx;var hJ=hI.cy;var e=hI.radius;T.style.left=(i-e)+"px";T.style.top=(hJ-e)+"px";T.style.width=(e*2)+"px";T.style.height=(e*2)+"px";if(C.Browser.ie===6){T.style.display="none";T.style.display=""}};');
